# 汉字练习册生成器 - 需求文档

## 1. 项目概述

### 1.1 项目名称
汉字练习册生成器 (Chinese Character Practice Generator)

### 1.2 项目描述
基于Next.js + TypeScript + TailwindCSS开发的在线汉字练习册生成工具，支持多种练习模式、格子类型和字体样式，能够生成高质量的PDF练习册供用户下载或打印。

### 1.3 项目目标
- 为学习者提供便捷的汉字练习册生成工具
- 支持多种练习模式，满足不同学习需求  
- 生成高质量的PDF文件，适合打印使用
- 提供友好的用户界面和流畅的操作体验

### 1.4 目标用户
- 汉语学习者（母语及外语学习者）
- 中小学语文教师
- 家长和教育工作者
- 书法爱好者

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 练习模式
1. **文章字帖** (`article`)
   - 根据输入的文章内容生成练习册
   - 自动去重并按字符出现顺序排列
   - 支持长文本分页显示

2. **带笔顺字帖** (`stroke-order`)
   - 显示汉字的标准笔顺
   - 包含笔画顺序指导
   - 适合初学者练习

3. **单字强化帖** (`single-char`)
   - 针对特定汉字的重复练习
   - 单个字符多次出现
   - 强化记忆效果

4. **英文字帖** (`english`)
   - 支持英文字母和单词练习
   - 适合英语学习者

#### 2.1.2 格子类型
1. **田字格** (`tian-zi`)
   - 传统的汉字练习格子
   - 包含十字辅助线
   - 帮助掌握汉字结构

2. **米字格** (`mi-zi`)
   - 八条辅助线的格子
   - 更精确的字符定位
   - 适合书法练习

3. **空白格** (`blank`)
   - 无辅助线的简洁格子
   - 适合有基础的学习者

#### 2.1.3 字体选项
1. **常规字体** (`chinese-regular`) - 宋体
2. **书法字体** (`chinese-calligraphy`) - 楷体
3. **行书字体** (`stroke-order`) - 行书
4. **隶书字体** (`english`) - 隶书

#### 2.1.4 文字显示控制
1. **透明度选项**
   - 浅灰 (15% 透明度)
   - 中灰 (25% 透明度)  
   - 深灰 (35% 透明度)

2. **字体大小调节**
   - 范围：20-80像素
   - 实时预览效果

### 2.2 页面布局设置

#### 2.2.1 网格配置
- **网格大小**: 30-80像素可调
- **行数**: 8-20行可选
- **列数**: 6-15列可选，自动计算最佳网格大小
- **间距**: 1-5像素可调

#### 2.2.2 页面信息
- 显示练习内容的字符范围
- 自动分页处理
- 页面标题自定义

### 2.3 PDF导出功能

#### 2.3.1 导出选项
1. **标准PDF导出**
   - 使用html2canvas + jsPDF
   - 高质量渲染（Scale: 3）
   - A4纸张规格

2. **增强PDF导出**
   - 字体嵌入支持
   - 使用Noto Sans SC字体
   - 字体回退机制
   - 更好的中文渲染

3. **浏览器打印**
   - 利用浏览器原生打印功能
   - 优化的打印样式
   - 更好的字体兼容性

#### 2.3.2 PDF优化特性
- 删除页码显示（保留字符范围）
- 减少页面留白，充分利用纸张空间
- 优化字体大小和位置
- 确保字体颜色正确显示
- 支持字体嵌入或标准字体替代

### 2.4 数据持久化
- 使用localStorage保存用户设置
- 自动保存和恢复配置
- 页面刷新后保持用户偏好

### 2.5 响应式设计
- 支持桌面和移动设备
- 移动端折叠式设置面板
- 自适应布局调整

## 3. 技术规格

### 3.1 技术栈
- **前端框架**: Next.js 15.3.3
- **开发语言**: TypeScript 5
- **样式框架**: TailwindCSS 3.3.0
- **UI框架**: React 18
- **PDF生成**: 
  - jsPDF 2.5.1
  - html2canvas 1.4.1
  - @react-pdf/renderer 4.3.0

### 3.2 项目结构
```
├── app/                    # Next.js App Router
│   ├── globals.css        # 全局样式
│   ├── layout.tsx         # 根布局组件
│   └── page.tsx           # 主页面
├── components/            # React组件
│   ├── ArticlePractice.tsx      # 文章练习组件
│   ├── BlankGridPaper.tsx       # 空白格子纸组件
│   ├── EnglishPractice.tsx      # 英文练习组件
│   ├── ExportButton.tsx         # 导出按钮组件
│   ├── FontSelector.tsx         # 字体选择器
│   ├── GridCell.tsx             # 网格单元格组件
│   ├── GridRow.tsx              # 网格行组件
│   ├── PinyinPractice.tsx       # 拼音练习组件
│   ├── PracticeGrid.tsx         # 练习网格组件
│   ├── PracticeSheetPreview.tsx # 预览组件
│   ├── PracticeText.tsx         # 练习文本组件
│   ├── SettingsPanel.tsx        # 设置面板组件
│   ├── SingleCharPractice.tsx   # 单字练习组件
│   └── StrokeOrderPractice.tsx  # 笔顺练习组件
├── types/                 # TypeScript类型定义
│   └── index.ts          # 核心类型定义
├── utils/                # 工具函数
│   ├── advancedPdfExport.ts    # 增强PDF导出
│   └── pdfExport.ts            # 标准PDF导出
└── 配置文件...
```

### 3.3 核心类型定义

#### 3.3.1 基础类型
```typescript
// 网格类型
type GridType = 'blank' | 'tian-zi' | 'mi-zi' | 'four-line';

// 练习模式
type PracticeMode = 'stroke-order' | 'article' | 'single-char' | 'english';

// 字体类型
type FontType = 'chinese-regular' | 'chinese-calligraphy' | 'stroke-order' | 'english';

// 文字透明度
type TextOpacity = 'light' | 'medium' | 'dark';
```

#### 3.3.2 配置接口
```typescript
// 网格配置
interface GridConfig {
  type: GridType;
  size: number;        // 网格大小(像素)
  rows: number;        // 行数
  cols: number;        // 列数
  spacing: number;     // 间距
}

// 文字配置
interface TextConfig {
  content: string;     // 练习内容
  font: FontType;      // 字体
  opacity: TextOpacity; // 透明度
  size: number;        // 字体大小
  showPinyin?: boolean; // 显示拼音
  showStrokeOrder?: boolean; // 显示笔顺
}

// 练习册配置
interface PracticeSheetConfig {
  mode: PracticeMode;
  grid: GridConfig;
  text: TextConfig;
  title?: string;
  paperSize: 'A4';
  includeHeader?: boolean;
  includeFooter?: boolean;
}
```

### 3.4 性能优化
- 组件懒加载
- 防抖输入处理
- 虚拟滚动（长内容）
- 图片压缩和优化
- 代码分割

## 4. 用户界面设计

### 4.1 页面布局
- **左侧**: 设置面板（桌面端固定，移动端可折叠）
- **右侧**: 练习册预览区域
- **顶部**: 应用标题和导航（可选）

### 4.2 设置面板功能区
1. **内容输入区**: 多行文本输入框
2. **练习模式选择**: 下拉选择器
3. **格子类型选择**: 单选按钮组
4. **字体设置**: 字体选择器 + 大小滑块
5. **透明度控制**: 单选按钮组
6. **网格参数调节**: 数值输入框和滑块
7. **标题设置**: 文本输入框

### 4.3 预览区域
- **练习册预览**: 实时显示生成效果
- **导出按钮**: PDF导出和打印选项
- **状态指示**: 导出进度和结果反馈

### 4.4 响应式适配
- **桌面端**: 左右分栏布局
- **平板端**: 上下布局或折叠侧栏
- **移动端**: 垂直堆叠，设置面板可折叠

## 5. 用户体验流程

### 5.1 基本使用流程
1. **输入内容**: 用户在文本框中输入要练习的内容
2. **选择模式**: 选择适合的练习模式
3. **调整设置**: 配置格子类型、字体、透明度等参数
4. **预览效果**: 实时查看生成的练习册样式
5. **导出PDF**: 选择导出方式并下载文件

### 5.2 高级使用场景
1. **教师备课**: 
   - 输入课文内容生成配套练习册
   - 调整难度和格式适应学生水平
   - 批量生成不同版本

2. **家长辅导**:
   - 根据孩子薄弱字符生成针对性练习
   - 设置合适的字体大小和透明度
   - 打印后供孩子练习

3. **自主学习**:
   - 输入生词或文章进行练习
   - 选择喜欢的格子类型和字体
   - 循序渐进调整难度

### 5.3 错误处理
- 输入验证和提示
- 导出失败重试机制
- 网络异常处理
- 浏览器兼容性提示

## 6. 数据流设计

### 6.1 状态管理
- 使用React useState管理组件状态
- 通过props传递配置数据
- localStorage持久化用户设置

### 6.2 数据流向
```
用户输入 → 状态更新 → 组件重渲染 → 预览更新 → 本地存储
```

### 6.3 配置同步
- 设置面板变更触发预览更新
- 自动保存到localStorage
- 页面加载时恢复保存的配置

## 7. 质量保证

### 7.1 测试策略
- **单元测试**: 核心工具函数测试
- **集成测试**: 组件交互测试  
- **端到端测试**: 完整用户流程测试
- **兼容性测试**: 多浏览器测试

### 7.2 性能指标
- **首屏加载时间**: < 3秒
- **交互响应时间**: < 100ms
- **PDF生成时间**: < 5秒（标准内容）
- **内存使用**: < 100MB

### 7.3 浏览器支持
- **现代浏览器**: Chrome 80+, Firefox 75+, Safari 13+, Edge 80+
- **移动浏览器**: iOS Safari 13+, Chrome Mobile 80+
- **功能降级**: 不支持的浏览器提供基础功能

## 8. 部署和维护

### 8.1 部署方案
- **生产环境**: Vercel/Netlify静态部署
- **开发环境**: 本地Next.js开发服务器
- **构建优化**: 自动代码分割和压缩

### 8.2 监控和分析
- **错误监控**: Sentry错误追踪
- **性能监控**: Web Vitals指标
- **用户分析**: 使用统计和行为分析

### 8.3 更新维护
- **功能迭代**: 基于用户反馈持续优化
- **依赖更新**: 定期升级技术栈
- **安全更新**: 及时修复安全漏洞

## 9. 扩展规划

### 9.1 功能扩展
- **更多格子类型**: 三线格、四线格等
- **批量处理**: 支持文件上传和批量生成
- **模板系统**: 预设练习册模板
- **云端同步**: 用户账户和云端存储

### 9.2 技术升级
- **PWA支持**: 离线使用能力
- **国际化**: 多语言界面支持
- **主题系统**: 深色模式和自定义主题
- **API接口**: 提供开发者API

### 9.3 生态建设
- **插件系统**: 第三方扩展支持  
- **社区分享**: 用户生成内容分享
- **教育合作**: 与学校和机构合作
- **商业化**: 高级功能和服务

---

**文档版本**: v1.0  
**最后更新**: 2024年12月  
**项目状态**: 开发完成，持续优化中